<h3 style="text-align: left;">&nbsp;TL;DR</h3><div style="text-align: left;"><ul style="text-align: left;"><li>We're going to explore electronics of analog (POTS) phone and use some existing pulse to tone converter projects to make it work with contemporary landline</li><li>We're going to extend functionality of such converter to provide classic Pulse-Tone switch known from later models</li><li>Firmware, PCB (Gerber files), BOM and assembly instructions are available at the end of this documentfghfgh&nbsp;</li></ul>&nbsp;</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;">There is this city in Poland, called Radom. It is believed to be one of the worst cities to live in.<br /><br />As the famous saying goes: <br /></div><div style="text-align: left;"></div><blockquote><div style="text-align: left;">- So, you're almost 40. Thinking abount getting married? Some children maybe?</div><div style="text-align: left;">- Yep, first thing after getting back from Radom.</div><div style="text-align: left;">- So you're going to Radom! When exactly?</div><div style="text-align: left;">- I'm not going to go there at all :)</div></blockquote><div style="text-align: left;">Tens of years ago, when Poland was a proud member of eastern block, Radom was also famous of two things: small arms factory "<i>Łucznik</i>" and RWT (<i>Radomska Wytwórnia Telekomunikacyjna</i>) - a company producing phones. By the way - it's a nice way of marketing to name a company by the city it is located in and the items it produces (RWT translates directly to <i>Radom's Factory of Phones</i>). Well... I've just recalled <i>Detroit Diesel</i> and <i>Texas Instruments</i>... nevermind.<br /><br />Anyway, one of the RWT's products is the subject of this article. Let me present RWT Elektrim (codename CB-664) - an ancient analog phone with rotary dial. Our job for today is to make it work with modern landline.</div><div style="text-align: left;"></div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEhFhkvxTiJ0W7xP6XBnQQ94OYG7vmdL-4bW__TYA_rdZA4VwScm1V-OcispN6XQ1yEnS4y7M92PiEFXr2M3jYidxBhDqr5stmow1jX8g3sXUZvOJz9yg-nnrxCZkogx9MUgkXJK36YMoEbY2QaIi3SSYMFTYtiTNLpC5XURYOYUOAi80G4dG46LuETarRUs" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="2624" data-original-width="3559" height="472" src="https://blogger.googleusercontent.com/img/a/AVvXsEhFhkvxTiJ0W7xP6XBnQQ94OYG7vmdL-4bW__TYA_rdZA4VwScm1V-OcispN6XQ1yEnS4y7M92PiEFXr2M3jYidxBhDqr5stmow1jX8g3sXUZvOJz9yg-nnrxCZkogx9MUgkXJK36YMoEbY2QaIi3SSYMFTYtiTNLpC5XURYOYUOAi80G4dG46LuETarRUs=w640-h472" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEjBBJcSE8ILQSYLZzsrd23kihH_ZzfVqMKjn620-a0PBv1J8GTN8YDEKjUcEOJX7kXFEfvR6hpurnPZ7WQ_Giv7sCtyqx93SOyIcG5W8QIAgK2SEv7A8B-f6-K0G415QlyiSEklQZlF1JYW9RrS6L-X7m0tibv0sXJ53p3arwPHuZ0OnHmmhqWwdPoF4t-r" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="2152" data-original-width="3112" height="442" src="https://blogger.googleusercontent.com/img/a/AVvXsEjBBJcSE8ILQSYLZzsrd23kihH_ZzfVqMKjn620-a0PBv1J8GTN8YDEKjUcEOJX7kXFEfvR6hpurnPZ7WQ_Giv7sCtyqx93SOyIcG5W8QIAgK2SEv7A8B-f6-K0G415QlyiSEklQZlF1JYW9RrS6L-X7m0tibv0sXJ53p3arwPHuZ0OnHmmhqWwdPoF4t-r=w640-h442" width="640" /></a></div></div><div style="text-align: center;">(RWT Elektrim CB-664)<br /></div><div style="text-align: left;"><h3>Motivation</h3>My motivation for this project is to get a handy tool to annoy my coworkers. I needs it to be fully functional in order to mitigate any excuses for throwing it out of the window. Also, besides some amount of nostalgia (I owned the same model some 30 years ago), the text "<i>If it annoys you, just change the ringtone</i>" is the one I'm especially proud of.<br /><h3 style="text-align: left;"><b>Analog telephony</b></h3>I'm a computer networks engineer with minor experience in VoIP and enthusiast of electronics, so pardon my layman's approach to analog telephony. I'm gonna focus only on what happens inside the phone and between the phone and a wall socket when one is dialing a number, talking and when the phone is ringing.<br /><br />So, as far as I'm concerned, a classic landline consists of two copper wires (a copper pair). The potential difference between them when the line is idle (i.e. phone not working in any way or not connected to the socket at all) is 48V DC nominal. Could we tap into these 48V to power our phone's "standby" circuitry? I don't think so. I don't believe there is any standarised "current yield" of the landline greater than "nothing", and any form of load between these two wires would quickly result in radical voltage drop. This will become important in a moment.<br /><br />An analog phone has a hook, a mechanical switch that connects some audio circuitry to the line at the moment the receiver is picked up. This typically consists of microphone and speaker connected in series. It is connected to the line using a transformer. Let's skip a problem of <a href="https://en.wikipedia.org/wiki/Sidetone" target="_blank">sidetone</a> for now. Also, there needs to be a way to signal "receiver off-hook" state to the exchange. This is done by drawing some current off the line. Thats why a 100-ohm resistor in parallel to the audio circuitry <br />"shorts" the line when the hook is activated. <br /></div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEgKB5MA4XkOQxQ6J5vm05kngKEXp-IKvMS4muXuw29_lEvqSSnsrrChAgge7gHhmEoLKhIRDWhl4pmoBVFSbmxrunOoTBYucQoIFtzxN_lqXP4HSe26GjezTZkmttV3FqjCFNsE2DX8G30DOeM8dOlk8U7QhOmyOLQxoVWHbdKtQ4Oiw4RBlLXpGUOvy5ij" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="2974" data-original-width="3970" height="300" src="https://blogger.googleusercontent.com/img/a/AVvXsEgKB5MA4XkOQxQ6J5vm05kngKEXp-IKvMS4muXuw29_lEvqSSnsrrChAgge7gHhmEoLKhIRDWhl4pmoBVFSbmxrunOoTBYucQoIFtzxN_lqXP4HSe26GjezTZkmttV3FqjCFNsE2DX8G30DOeM8dOlk8U7QhOmyOLQxoVWHbdKtQ4Oiw4RBlLXpGUOvy5ij=w400-h300" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEhxX2ju_Uh3gLFOCETIiixspmUNrX3UCT9AtKXLgSvh4jSJ8z3WE7Vt4mA1qfNF4vIT7GDlcH3BE6hu8pzCDaNUMwQ1kKgVpRsLYdmHL5ZK4YYdISfaQsqMniEVu4LOQ1FJ3M6tLAYJHu8CjTwumvTj-0d8_E28hGvDbMbI0Ow6VsFp8PGrFGCaQUT6jxY5" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="2997" data-original-width="3702" height="324" src="https://blogger.googleusercontent.com/img/a/AVvXsEhxX2ju_Uh3gLFOCETIiixspmUNrX3UCT9AtKXLgSvh4jSJ8z3WE7Vt4mA1qfNF4vIT7GDlcH3BE6hu8pzCDaNUMwQ1kKgVpRsLYdmHL5ZK4YYdISfaQsqMniEVu4LOQ1FJ3M6tLAYJHu8CjTwumvTj-0d8_E28hGvDbMbI0Ow6VsFp8PGrFGCaQUT6jxY5=w400-h324" width="400" /></a></div></div><div style="text-align: center;">(Hook and its internals in <i>Elektrim</i>. Looks like 4PDT to me.)</div><div style="text-align: center;">&nbsp;</div><div style="text-align: left;"><br /></div><div style="text-align: left;"></div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEhEH-44WQZ-rYgp3lz2kwE4SLnczvTZQnUqbp9RtfnxBfHwItbIStkUYzuZ-cCEQuB2FUFM9cQo4afQArpWe7QdCwP0_j7GAwhkjSgc1RLZ8L_0Mfbaej_6lNqgULEr3WiV8B4uV1ITelSvb0RK4uDrnKMTnqzMkLFbj8xxT_QxnfMJIoL5zBqwWXD3lAYi" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="581" data-original-width="872" height="426" src="https://blogger.googleusercontent.com/img/a/AVvXsEhEH-44WQZ-rYgp3lz2kwE4SLnczvTZQnUqbp9RtfnxBfHwItbIStkUYzuZ-cCEQuB2FUFM9cQo4afQArpWe7QdCwP0_j7GAwhkjSgc1RLZ8L_0Mfbaej_6lNqgULEr3WiV8B4uV1ITelSvb0RK4uDrnKMTnqzMkLFbj8xxT_QxnfMJIoL5zBqwWXD3lAYi=w640-h426" width="640" /></a></div><div style="text-align: center;">(general phone schematics, <a href="https://sk6.webnode.page/l/this-is-a-blog-post-with-images15/">https://sk6.webnode.page/l/this-is-a-blog-post-with-images15/</a>)</div><div style="text-align: center;">&nbsp;</div><div style="text-align: center;">&nbsp;</div></div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEiqllCHVH7cbF6vNp8-s8lM3reUmsX-k_E99zrR3h0c_3Wo6rme7o-VuQRK3teO-plWkeJsP_eZ5iXAvMFP7p8UIktScvM7S4IukY9aqbAMoVAUfKsOcFAFNj0ZL3Cdk2CxlchCk1QsAZBblyut3qmV7Na-cgz6ZEP6B8giwV15dwTEamCspQEsfyeD3mp7" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="264" data-original-width="602" height="280" src="https://blogger.googleusercontent.com/img/a/AVvXsEiqllCHVH7cbF6vNp8-s8lM3reUmsX-k_E99zrR3h0c_3Wo6rme7o-VuQRK3teO-plWkeJsP_eZ5iXAvMFP7p8UIktScvM7S4IukY9aqbAMoVAUfKsOcFAFNj0ZL3Cdk2CxlchCk1QsAZBblyut3qmV7Na-cgz6ZEP6B8giwV15dwTEamCspQEsfyeD3mp7=w640-h280" width="640" /></a></div></div><div style="text-align: center;">(even more simple general phone schematics, <a href="https://tekom.24ok.pl/baza-wiedzy/13-podstawowe-informacje-o-lacznosci-telefonicznej">https://tekom.24ok.pl/baza-wiedzy/13-podstawowe-informacje-o-lacznosci-telefonicznej</a>)</div><div style="text-align: left;"><br /></div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEhNIDX0rYe3JQDYdni-65LwXbLmrfixv7fyCkTsbagmXtDHP-dGEbuhtRdAMi2VFmxv6DQt0LOmkNIpj9DPB2ECoUdUf51X1TLH8m0594IA1aWzZTjYhYVkteaqyG3QTluNDUV616nLJwxv5WR3Wo7xvAqeTlTQ8kCHUx_NXhKxwEQfV5RH27r8rwsShCiN" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="2064" data-original-width="3002" height="440" src="https://blogger.googleusercontent.com/img/a/AVvXsEhNIDX0rYe3JQDYdni-65LwXbLmrfixv7fyCkTsbagmXtDHP-dGEbuhtRdAMi2VFmxv6DQt0LOmkNIpj9DPB2ECoUdUf51X1TLH8m0594IA1aWzZTjYhYVkteaqyG3QTluNDUV616nLJwxv5WR3Wo7xvAqeTlTQ8kCHUx_NXhKxwEQfV5RH27r8rwsShCiN=w640-h440" width="640" /></a></div><div style="text-align: center;">(schematics of RWT Elektrim, can be found inside the case... good old times :) )<br /></div></div><div style="text-align: left;"><br /></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;">A hook has one more purpose. It is used to disable the phone's bell as soon as the receiver gets picked up. Which brings us to the ringing mechanics. The whole idea of making phone ringing is to add a bell between line wires. If the exchange sends some AC in addition to 48V, it can run a coil-based bell without any problem... except a coil being a simple short for DC. Placing just a coil between line wires would short them and signal the phone being constantly off-hook (busy) to the exchange. Yet, we have this clever device to pass through an AC and completely stop any DC in the same time... a capacitor. I hope I don't need to say all this needs to happen before the hook to make ringing possible in on-hook state.<br /><br />To sum up, when the receiver is picked, bell-capacitor circuitry gets bypassed using 100-ohm resistor, current is drawn from the line to signal off-hook state to the exchange and audio circuitry gets connected to the line using a transformer.<br /><br />One final piece of this puzzle i a mechanism for dialing a number. For vintage phones dialing is possible only in off-hook state. It means any dialing circuitry needs to be located after the hook. Here the legendary phone dial kicks in.<br /><br />An old signalling standard for dialing a single digit is simply to disconnect from landline (to stop drawing current) as many times as the digit indicates. Except of 0, obviously, for which 10 such "pulses" should be produced. Pulsing should occur at precise frequency of 10 Hz +/-0.5 (although <a href="https://en.wikipedia.org/wiki/Rotary_dial">https://en.wikipedia.org/wiki/Rotary_dial</a> suggests even more liberal constraints). I found no information about duty cycle requirement. Also it's worth noting that some scandinavian countries and New Zealand used to use reverse system: 1 = 9 pulses, 2 = 8 pulses, etc.<br /><br />Fixing frequency of pulse-generation is typically implemented using purely mechanical means. For instance, in CB-664, a 10 Hz pulsing frequency is achieved via mechanical centrifugal brake regulator.</div><div style="text-align: left;"><br /></div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEjx_jxSJXnuDgtFyrcW2LfUlM5xxAONuq8oJXzzNM_DA8mPFCtF0IZUto4ULt2qbo-N6swBZpU04cQAJSEISIirNJVa0s3mnf5wZqwoFSfXg3C9x0YurqYV5MoQSI6LfPFgDiaViADWUW2ALtvC1aw61J9LHmSo2Zsq5sorQfcybTuIjnZH-23-nxdhl-T_" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="3454" data-original-width="3009" height="640" src="https://blogger.googleusercontent.com/img/a/AVvXsEjx_jxSJXnuDgtFyrcW2LfUlM5xxAONuq8oJXzzNM_DA8mPFCtF0IZUto4ULt2qbo-N6swBZpU04cQAJSEISIirNJVa0s3mnf5wZqwoFSfXg3C9x0YurqYV5MoQSI6LfPFgDiaViADWUW2ALtvC1aw61J9LHmSo2Zsq5sorQfcybTuIjnZH-23-nxdhl-T_=w557-h640" width="557" /></a></div><div style="text-align: center;">(Mechanics at the back of RWT's dial. Regulator is in bottom right.)</div><div style="text-align: center;"></div></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEjx7vvx9WK2A6YRlW4x-5aaNTcr-PiykahQnUSe39kjvwdiAX_1cicGN2uIy2VDNKFNBpTmRWSBCs8_SW8Rt-2gMjYZ8ogZCThh0ELGhw0XRuwSl0M093Z4_cqavDpE_vnCzNSD-Ay1EEoNjvpMN2Tdwnus6kWX2ImCs5YWV2w-vRNgVFQ-_N8JznF2RAwZ" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="2408" data-original-width="1969" height="640" src="https://blogger.googleusercontent.com/img/a/AVvXsEjx7vvx9WK2A6YRlW4x-5aaNTcr-PiykahQnUSe39kjvwdiAX_1cicGN2uIy2VDNKFNBpTmRWSBCs8_SW8Rt-2gMjYZ8ogZCThh0ELGhw0XRuwSl0M093Z4_cqavDpE_vnCzNSD-Ay1EEoNjvpMN2Tdwnus6kWX2ImCs5YWV2w-vRNgVFQ-_N8JznF2RAwZ=w523-h640" width="523" /></a></div><br /><br /></div><div style="text-align: center;">(Mechanics of another dial I own. Also, large black wheel at the top is the regulator.)<br /></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"><br />Studying internals of a dial leads to another conclusion. To produce clear pulses, it is important to mute audio circuitry while pulsing. This is done by dial shorting the audio circuitry for the whole period of pulsing a single digit.</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;">I believe the time limit between digits is something about 5 secs.<br /><br />It is finally worth mentioning, that there is no techncal difference between pulsing using a dial and putting receiver back on hook. So if you'd be able to activate hook by hand at fixed frequency of 10 times a second, you'd be able to dial a number, even if the dial itself would be deactivated for some reason. This is indeed an idea behind mechanism of phreaking (<a href="https://en.wikipedia.org/wiki/Phreaking">https://en.wikipedia.org/wiki/Phreaking</a>).<br /><h3 style="text-align: left;">DTMF</h3>Dialing by pulsing is an obsolete mechanism. Only some of public phone operators still support it. Also I've been able to test it on some VoIP adapters with varying results: <i>Grandstream GXW-4024</i> (ca. 2012) still supports it, but has extremely strict requirements for pulsing frequency. <i>Cisco SPA8000</i> and <i>PAP2T </i>do not seem to support it at all.<br /><br />Pulse dialing got replaced by DTMF. Popularisation of integrated circuits eased the development and production of phones able to produce in-audio short bursts of certain fixed frequency (a tone). Moreover, as audio channel in analog telephony has relatively narrow band (just enough to transmit human voice), it may be desirable to combine two orthogonal frequencies during burst. This is exactly how DTMF works. It stands for Dual-tone Multi-Frequency signalling. Any digit being dialed has unique combination of two frequencies assigned to it. Dialing it produces short burst of in-audio tone transmitted further to the exchange. Obviously this method is much more simple to implement when the phone has a keypad instead of a dial. Nevertherless DTMF has became a de-facto standard for dialing in analog telephony.</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEi5yi1jp_PomHevJWbBKbU0G7960DOVyCNQD89lAlfAlAJ9Q2RIKzD6yyfU5jI-2DHuXk_SCJEyrdvjZbjEB1FdXLzGi1Uf4xiSRx6oabkVZ-ViIRJ1dk7TfCY6uJeL5t1m15E2umaqT2I0AZQryL7PH-7nf8f3_9C80BjWvRjHtnqoV9wzWYWmV_ekZ5kA" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="1600" data-original-width="2400" height="426" src="https://blogger.googleusercontent.com/img/a/AVvXsEi5yi1jp_PomHevJWbBKbU0G7960DOVyCNQD89lAlfAlAJ9Q2RIKzD6yyfU5jI-2DHuXk_SCJEyrdvjZbjEB1FdXLzGi1Uf4xiSRx6oabkVZ-ViIRJ1dk7TfCY6uJeL5t1m15E2umaqT2I0AZQryL7PH-7nf8f3_9C80BjWvRjHtnqoV9wzWYWmV_ekZ5kA=w640-h426" width="640" /></a></div></div><div style="text-align: center;">(RWT <i>Cyklamen 02</i>, a keypad prototype based on RWT <i>Elektrim</i>, <a href="http://telesfor.org/telefony-modele/pozostale/">http://telesfor.org/telefony-modele/pozostale/</a>)<br /></div><div style="text-align: left;"><br />You can find frequency assignments for each key of keypad on Wikipedia: <a href="https://en.wikipedia.org/wiki/DTMF">https://en.wikipedia.org/wiki/DTMF</a>.<br /><h3 style="text-align: left;"><i>Rotatone</i> and <i>rotarydial</i> projects</h3>My Elektrim was produced in 1971. Despite DTMF being dated back to 1963, I'm pretty sure in 1971 noone in Poland even heard of it.<br /><br />With fading support for pulse dialing at the operator level, there are certain projects to incorporate DTMF into dial-based phones. First one worth mentioning is the <i>Rotatone</i> (<a href="https://oldphoneworks.com/products/rotatone-pulse-to-tone-converter">https://oldphoneworks.com/products/rotatone-pulse-to-tone-converter</a>): cheap, small, yet commercial device used to convert pulses produced by dial to DTMF tones. In addition to standard 10-digit functionality, it supports dialing hash (#) and asterisk(*), and allows to use phonebook of some (5 - as far as I remember) frequently dialed numbers. Available both in form of in-phone device and an external "filter" mounted on phone cable, this feature-rich solution would be ideal except for one additional requirement I have.</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEiDo-7n6sTqkbXLo3iNp_zjyHYAPsgVqM2b8r58fsZ9Kn7PM_JUeNxhGHp-YdRsBXA6zTCBGcwr5lrQnObk-QHElE9XZ5pA7mW7zq7MKCfrPwXuLfWu_h5_PHDNeqEhQzPMXVWbxmQzbfe8YiS3-U4cUu-dpt4wvoWerVdkq9YcwACfb2Z968CKp9PWJONZ" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="720" data-original-width="800" height="359" src="https://blogger.googleusercontent.com/img/a/AVvXsEiDo-7n6sTqkbXLo3iNp_zjyHYAPsgVqM2b8r58fsZ9Kn7PM_JUeNxhGHp-YdRsBXA6zTCBGcwr5lrQnObk-QHElE9XZ5pA7mW7zq7MKCfrPwXuLfWu_h5_PHDNeqEhQzPMXVWbxmQzbfe8YiS3-U4cUu-dpt4wvoWerVdkq9YcwACfb2Z968CKp9PWJONZ=w400-h359" width="400" /></a></div></div><div style="text-align: center;">(Rotatone SMD, <a href="https://oldphoneworks.com/products/rotatone-pulse-to-tone-converter">https://oldphoneworks.com/products/rotatone-pulse-to-tone-converter</a>)</div><div style="text-align: center;">&nbsp;</div><div style="text-align: center;">&nbsp;</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEitx3KXTJx1o3K3p-NCOULKZFdQIH9zAgvpHa6YMn-IJzU0p99W94cSyzzAEld6xS4_BUSssG31eHe9O0GhOpeD4_WdovoNZto4dDOmZxRLtOXKTHiDc8wT3PnEqFgD0oy0Bz2cMzZU7Kzg23ouGW_1HyffuSgSq0JRNJIbYUpTvNOKh1oLZxdLyY_Zf1It" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="4000" data-original-width="4000" height="400" src="https://blogger.googleusercontent.com/img/a/AVvXsEitx3KXTJx1o3K3p-NCOULKZFdQIH9zAgvpHa6YMn-IJzU0p99W94cSyzzAEld6xS4_BUSssG31eHe9O0GhOpeD4_WdovoNZto4dDOmZxRLtOXKTHiDc8wT3PnEqFgD0oy0Bz2cMzZU7Kzg23ouGW_1HyffuSgSq0JRNJIbYUpTvNOKh1oLZxdLyY_Zf1It=w400-h400" width="400" /></a></div></div><div style="text-align: center;">(Rotatone EXT, <a href="https://oldphoneworks.com/products/rotatone-pulse-to-tone-converter">https://oldphoneworks.com/products/rotatone-pulse-to-tone-converter</a>)<br /></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"><br />&nbsp;</div><div style="text-align: left;">An open-source alternative to <i>Rotatone</i> has been refined from some projects generally available on the internet by Matthew Millman (<a href="https://www.mattmillman.com/projects/building-your-own-pulse-to-tone-converter/">https://www.mattmillman.com/projects/building-your-own-pulse-to-tone-converter/</a>). While a bit less feature-rich, it is extremely simple, and due to its openness, can be made part of a more complicated device. This is want we want!<br /><h3>Details of Matthew Millman <i>rotarydial</i> project</h3>Matthew's pulse-to-tone converter (let's call it "<i>rotarydial</i>" for short) is based on jellybean Atmel's ATtiny85V microcontroller. Guess what! Even Atmel predicted its use for generating DTMF tones. There's an Application Note describing how to generate DTMFs using 85V's PWM module. And while in-dial contacts can be used to short some microcontroller inputs to ground (no need to use pull-up resistors; 85V has its own in it!), all we need is a way to tap into the line. Here is where rotarydial gets clever. In order to impose DTMF on the line, it kind-of shorts it via itself. Using one of its outputs and a 680-ohm resistor (in order not to exceed limit of ca. 15 mA above which output gets fried) it passes some current from the positive wire to the negative. If the output changes its state at certain frequency, it makes a great way to produce a frequency on line.</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEgnAFwzyQrpiYUKMc-7Y1G4FmXeMCZ-jTon6HM3A7GOFDog0wA2AgP-3coZhx_5V_OXrbizUSsLTafkZEI_AgAPCeXRetSuvxHof1EFuvnNM5S6i8H_iUVf3PtdS45gtOYJZXbuaNOvyX4rIKsudolBBsm0TcsQfOwNkNL-LHueAICPkRGvtihbp6mZDiaX" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="595" data-original-width="1455" height="262" src="https://blogger.googleusercontent.com/img/a/AVvXsEgnAFwzyQrpiYUKMc-7Y1G4FmXeMCZ-jTon6HM3A7GOFDog0wA2AgP-3coZhx_5V_OXrbizUSsLTafkZEI_AgAPCeXRetSuvxHof1EFuvnNM5S6i8H_iUVf3PtdS45gtOYJZXbuaNOvyX4rIKsudolBBsm0TcsQfOwNkNL-LHueAICPkRGvtihbp6mZDiaX=w640-h262" width="640" /></a></div></div><div style="text-align: center;">(<i>Rotarydial</i> schematics, <a href="https://www.mattmillman.com/projects/building-your-own-pulse-to-tone-converter/">https://www.mattmillman.com/projects/building-your-own-pulse-to-tone-converter/</a>)<br /></div><div style="text-align: left;"></div><div style="text-align: left;"><br />There are two things to consider when using microcontroller powered from the phone line. <br /><br />First of all, power supply of 85V cannot exceed 5V. This is ensured by L78L05 linear voltage regulator. Yet, even L78L05 has its upper limit for input voltage. At this moment, we need to return to the "current yield" of phone line. While idle line offers 48V DC, we need our microcontroller to work only in off-hook state, when the line is shorted by 100-ohm resistor. This reduces 48V to something more like 6-8V which L78L05 can accept directly. And in case of an overwoltage (hook malfunctioning, etc), a Zener diode with breakdown at 27V protects the whole circuit (L78L05 in particular, as it can accept at most 30V). Since off-hook line voltage is far below the Zener breakdown, a Zener diode should not affect audio in any way. Since it is connected to the line only in off-hook state, it also does not influence on-hook ringing.</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;">&nbsp;<div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEiWU5SOSVhLMfhXclYRcxs5SoY5wqIj8NTXBQNTWC8hYJ5FGa3o0Hl9ipkXW4eMtsMFGnpuCD5kwiJ4HTfvV3YN-OvEznLpY0x33t0RR2tc-LXpPaKIbt0GT9Bu0bsD-qpO0doFNHwD85sVw9MntmR-bLSCi4hkdGwGON9VGtVNtGOmIUfbpV1dh9b7pj6V" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="2497" data-original-width="2735" height="365" src="https://blogger.googleusercontent.com/img/a/AVvXsEiWU5SOSVhLMfhXclYRcxs5SoY5wqIj8NTXBQNTWC8hYJ5FGa3o0Hl9ipkXW4eMtsMFGnpuCD5kwiJ4HTfvV3YN-OvEznLpY0x33t0RR2tc-LXpPaKIbt0GT9Bu0bsD-qpO0doFNHwD85sVw9MntmR-bLSCi4hkdGwGON9VGtVNtGOmIUfbpV1dh9b7pj6V=w400-h365" width="400" />&nbsp;</a></div><div class="separator" style="clear: both; text-align: center;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEiwYDz6ef1HICXsRyF556xeq5ulzNgqrKXJv4ArnzYgkuLAzbfdV-b8Lm6A0yRutAZRs2CO1Zo8FdIFlRCnKlXdcVP3rt0P9QxClHoxBlmWOGDnhz8_wwDY7W5GmkkcJzIT6xtd_kEqt3V8cBA2yJCMbHwZ3gYP0GdbVno2b7iLblIFt4AInVk7Cc2eZQix" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="2096" data-original-width="3104" height="270" src="https://blogger.googleusercontent.com/img/a/AVvXsEiwYDz6ef1HICXsRyF556xeq5ulzNgqrKXJv4ArnzYgkuLAzbfdV-b8Lm6A0yRutAZRs2CO1Zo8FdIFlRCnKlXdcVP3rt0P9QxClHoxBlmWOGDnhz8_wwDY7W5GmkkcJzIT6xtd_kEqt3V8cBA2yJCMbHwZ3gYP0GdbVno2b7iLblIFt4AInVk7Cc2eZQix=w400-h270" width="400" /></a></div></div></div><div style="text-align: center;">(<i>Rotarydial</i> build, <a href="https://www.mattmillman.com/projects/building-your-own-pulse-to-tone-converter/">https://www.mattmillman.com/projects/building-your-own-pulse-to-tone-converter/</a>)</div><div style="text-align: left;"><h3 style="text-align: left;">My extension to <i>rotarydial</i></h3>So... what is rotarydial missing? <br /><br />First of all, as far as I know, rotarydial has been developed to be used in UK. British Telecom uses a special, "polarized" phone socket and plug system, that does not require you to care about which wire of the line is positive and which is negative. On the other hand, an analog phone, as shown above, does not care about polarity. Yet, the microcontroller does!<br /><br />So first thing we would need in order to adapt rotarydial to polish RWT <i>Elektrim</i>, that uses symmetric plug by default is to ensure <i>rotarydial</i> always get positive supply voltage. Easiest way to do this is to "rectify" a line using literally any Graetz bridge. And since we're dealing with rather low voltages (every diode has a forward voltage drop!), it is even better to build one yourself. All you need is 4 silicon diodes with forward drop of your choice (the lower, the better).</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;">&nbsp;<div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEi0-e-mkWU7wNTfX9YSby5A2wjfcBmcxfonwuGC-aGN4DDyILfVPKxLCbpDrEpdI7rGSdsPr6mfPEfKCw50sXIqC3KhWcQSebQZfdTAG5uahIV1I4Joivmcicxd6YdP_thTF9Ymdaq4jyItngG0CPSfRc0FaCwReihymQkI2M_xsQrdZW3kXsCLhpQMm1AQ" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="881" data-original-width="1181" height="299" src="https://blogger.googleusercontent.com/img/a/AVvXsEi0-e-mkWU7wNTfX9YSby5A2wjfcBmcxfonwuGC-aGN4DDyILfVPKxLCbpDrEpdI7rGSdsPr6mfPEfKCw50sXIqC3KhWcQSebQZfdTAG5uahIV1I4Joivmcicxd6YdP_thTF9Ymdaq4jyItngG0CPSfRc0FaCwReihymQkI2M_xsQrdZW3kXsCLhpQMm1AQ=w400-h299" width="400" /></a></div></div><div style="text-align: center;">(British Telephone plug, <a href="https://en.wikipedia.org/wiki/British_telephone_socket">https://en.wikipedia.org/wiki/British_telephone_socket</a>) <br /></div><div style="text-align: left;"><br />&nbsp;</div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEhPbUGc76Lnr3PH5b4YT7jXQ5YBKaHayGSqgwOERg9t4de36d45JkVnKlABkTzpGaooU_q66i2_r1saddWA5tWN2V7j-c1zvSICxHn0f-A9kGGh0OLpgRYwILKoxqRvOdXehVyTGlXPT4b3IHuvcOvQzUBl5Aj3tW0xem5MagEnqb9kONHTxHmRa2HzzxM0" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="2445" data-original-width="2586" height="378" src="https://blogger.googleusercontent.com/img/a/AVvXsEhPbUGc76Lnr3PH5b4YT7jXQ5YBKaHayGSqgwOERg9t4de36d45JkVnKlABkTzpGaooU_q66i2_r1saddWA5tWN2V7j-c1zvSICxHn0f-A9kGGh0OLpgRYwILKoxqRvOdXehVyTGlXPT4b3IHuvcOvQzUBl5Aj3tW0xem5MagEnqb9kONHTxHmRa2HzzxM0=w400-h378" width="400" /></a></div></div><div style="text-align: center;">(Ancient polish telephone plug (bakelite). As found in <i>Elektrim</i>.)</div><div style="text-align: center;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"></div><div style="text-align: left;">The other requirement is derived from an intention of modified phone being practical "to the extend permitted by applicable law". In most contemporary analog phones you can still find a P-T switch, used to choose between pulse and tone dialing. How about adding this thing to <i>Elektrim</i>?<br /><h3>P-T switch and WC relay coil triggering model</h3>Obviously, for a phone dial that has 3 leads, the first choice to route them either to phone directly or to <i>rotarydial </i>would be to install a manual switch.<br /><br />This very basic approach has 2 signifficant drawbacks:<br /><ol style="text-align: left;"><li>A switch that can route 3 signals to one of 2 different destinations (3PDT) would generally be massive. And, indeed, I wasn't able to find anything small enough to conveniently install it on <i>Elektrim</i>'s case. RWT <i>Elektrim</i> has been designed as if DTMF never existed. Obviously it has no P-T switch and even no suilatble place on the case to install one. </li><li>If you look closely at the schematics of a phone dial, you can see that it has two contacts: one between common lead and "mute", and one between common lead and "pulse". The thing is that when phone is not dialing, the first contact is NO, and the second is NC. State of contacts only changes while dialing a single digit ("mute" closed for the whole time, "pulse" producing "open" pulses). In order for rotarydial to work, "pulse"-"common" should be closed permanently on the phone side, when the the <i>rotarydial</i> is selected via P-T switch. We are dangerously close to requiring 4PDT.</li></ol><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEiTYTvUI1NDn9tKEU9Pre_bNUO1xgvNcUC48TRNz95Wp3dfQdC4gikZdwDL-pmSesjeCtxto6OuxU1-JQhSuptyWzBPhabgsEBxQcYiSo-5AH_haXbToueHU49qUTWHLhgvUpzYykYWpsODNmRCTPsbvSDWgM7wlyDO6NT0tMz5OpGLDcHS3SfqEpmDyIbD" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="1280" data-original-width="1280" height="400" src="https://blogger.googleusercontent.com/img/a/AVvXsEiTYTvUI1NDn9tKEU9Pre_bNUO1xgvNcUC48TRNz95Wp3dfQdC4gikZdwDL-pmSesjeCtxto6OuxU1-JQhSuptyWzBPhabgsEBxQcYiSo-5AH_haXbToueHU49qUTWHLhgvUpzYykYWpsODNmRCTPsbvSDWgM7wlyDO6NT0tMz5OpGLDcHS3SfqEpmDyIbD=w400-h400" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEjQGTFBEW5mnzCyltfWWBquuhp1gieukQfPpp58XKIHRbqmzxz7rc6kLfbSuvhWx8UeAraPP5HP3h2O3dm8u2d_IBauUmSQ8o-d_CTn427DHa9ZQh9tQHmeVdLy2M38c4Buz6ujC051tv4FMCYkbnUfOENjqYLfshZ6wvudp3AiMJoUphlcF-iIpPfGKYi7" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="1280" data-original-width="1280" height="400" src="https://blogger.googleusercontent.com/img/a/AVvXsEjQGTFBEW5mnzCyltfWWBquuhp1gieukQfPpp58XKIHRbqmzxz7rc6kLfbSuvhWx8UeAraPP5HP3h2O3dm8u2d_IBauUmSQ8o-d_CTn427DHa9ZQh9tQHmeVdLy2M38c4Buz6ujC051tv4FMCYkbnUfOENjqYLfshZ6wvudp3AiMJoUphlcF-iIpPfGKYi7=w400-h400" width="400" /></a></div></div><div style="text-align: center;">(Example of 3PDT switch and its dimensions)<br /></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"><br />So if a single mechanical switch is not the case, lets look at a group of switches that we can somehow synchronize.<br /><br />Just by coincidence, I have some of NEC/KEMET EC2 telecommunications bistable relays with coil rated for 3.3V. A bistable relay of this type has two coils: one requires short pulse of current to "set" the relay, i.e. to connect common lead to one output, and another, when activated by the same type of pulse, "resets" the relay, that is, connects common lead to another output. EC2 has two channels.</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEj2U53UZJJbabMMepAXKfVbHRCEoodxg5J5RmH2mbGNNfYytp4rmzvi0nwW1r-ahou2n7ZZFhX0zwnGazPKmGrfRLSYOZv0Qc_piGIprguLiC6KNk1_r39_hSSKwtx4vN-4nW1nAjilU5XPttEmxciULVs2ruPSS1woeoUZEUYrep8JUfqXCRFs-jQFPxQ6" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="500" data-original-width="500" height="400" src="https://blogger.googleusercontent.com/img/a/AVvXsEj2U53UZJJbabMMepAXKfVbHRCEoodxg5J5RmH2mbGNNfYytp4rmzvi0nwW1r-ahou2n7ZZFhX0zwnGazPKmGrfRLSYOZv0Qc_piGIprguLiC6KNk1_r39_hSSKwtx4vN-4nW1nAjilU5XPttEmxciULVs2ruPSS1woeoUZEUYrep8JUfqXCRFs-jQFPxQ6=w400-h400" width="400" /></a></div><div style="text-align: center;">&nbsp;(EC2-3TNU relay case)</div><div style="text-align: center;">&nbsp;</div></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEhC-a893ONYh5zXrWAqLM0JhFzkCsbYEfi-miBXbuiU79jHHSzPlmQAAZg8Mb1MY3uh4G8VnG0NIVzfAZKUsOoap9Vrw3t0Lsk9jjLNAyZyoPKPcJH4Fe2dltan-RUi1okVWPj4Av3SNnvZ6fnNCHlmPNPA5zFHU2UP6Dixqq8G8MuSEoUzbYg1k18a74DT" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="458" data-original-width="509" height="360" src="https://blogger.googleusercontent.com/img/a/AVvXsEhC-a893ONYh5zXrWAqLM0JhFzkCsbYEfi-miBXbuiU79jHHSzPlmQAAZg8Mb1MY3uh4G8VnG0NIVzfAZKUsOoap9Vrw3t0Lsk9jjLNAyZyoPKPcJH4Fe2dltan-RUi1okVWPj4Av3SNnvZ6fnNCHlmPNPA5zFHU2UP6Dixqq8G8MuSEoUzbYg1k18a74DT=w400-h360" width="400" /></a></div></div><div style="text-align: center;">(EC2-3TNU relay schematics)<br /></div><div style="text-align: left;"><br />Now, imagine combining 2 EC2s by connecting their "set" coils in serial and connection their "reset" coils in the same manner. Looks like we've just invented electrically driven 4PDT switch. Yeah, electrically...</div><div style="text-align: left;"><div style="text-align: center;">&nbsp;<a href="https://blogger.googleusercontent.com/img/a/AVvXsEhjq8VnYnD9njwLdAVW6aNvQv9NxPp-R7gY3qCKk2jKbmLjH4ZVfKFbXba9w56Evsw6MlOGcwrsJpIYZ5ELqpegEO_8VYsjbvfudTtTn045-zEkizqWaTSvxnAElP_lpBK6LffaXTXjQy2ouzkD_pIO8rB1-gIgeQuNqxzI2xm0fY0kHaAAUbNBJ9giXILH" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="418" data-original-width="286" height="400" src="https://blogger.googleusercontent.com/img/a/AVvXsEhjq8VnYnD9njwLdAVW6aNvQv9NxPp-R7gY3qCKk2jKbmLjH4ZVfKFbXba9w56Evsw6MlOGcwrsJpIYZ5ELqpegEO_8VYsjbvfudTtTn045-zEkizqWaTSvxnAElP_lpBK6LffaXTXjQy2ouzkD_pIO8rB1-gIgeQuNqxzI2xm0fY0kHaAAUbNBJ9giXILH=w273-h400" width="273" /></a></div><div style="text-align: center;">(Coils of 2 EC2s connected in series to construct 4PDT switch)<br /></div></div><div style="text-align: left;"><br />Using realys (even bistable ones) in current-constrained environment poses quite a challenge. First one is to minimize current that holds relay's moving contact in place. Obviously bistable relays have their holding current of 0 mA in both "set" and "reset" state (hence "bistable"). You only need to produce a pulse long enough for relay to switch to the opposite state. In order to produce a <b>pulse</b>, that is to cut off the coil current as soon as the relay finishes switching, it would be nice to use some kind of feedback loop. How about one of four available switches cutting of a current to the coil as soon as the relay changes state?</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEhz9JhQyL6gKFyuDI43kzjeoUiRdGq6T-97bzp8NETCYrm0JfxDEmr3BavKR02XvR__JP7Yltfm0W2R6YeAmYunk94_zqnWJc3w4-5b7a-oEEuIN2Tz-ZmOsPGs3Jur_rqgqBhJ9JYxX7xNysvox3m9r9gN8bzMLuaSOOSTFVlVIS3BBDRsiy8CvLAPBYQb" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="382" data-original-width="271" height="400" src="https://blogger.googleusercontent.com/img/a/AVvXsEhz9JhQyL6gKFyuDI43kzjeoUiRdGq6T-97bzp8NETCYrm0JfxDEmr3BavKR02XvR__JP7Yltfm0W2R6YeAmYunk94_zqnWJc3w4-5b7a-oEEuIN2Tz-ZmOsPGs3Jur_rqgqBhJ9JYxX7xNysvox3m9r9gN8bzMLuaSOOSTFVlVIS3BBDRsiy8CvLAPBYQb=w283-h400" width="283" /></a></div><div style="text-align: center;">(Feedback loop. First switch is part of relay 1, now in "set" position, just about to switch. Second switch is external, manually driven.)<br /></div></div><div style="text-align: left;"><br />While this setup reduces our switching abilities from 4PDT to 3PDT, it has a nice feature of consuming current only when it is absolutely needed.<br /><br />Sadly, relay does not switch instntaneously. In our setup, current to the coil is cut as soon as the switching (moving) part inside the relay <b>starts</b> moving. For coil voltage of 3.3V, this part often is unable to gain enough momentum to reach the other end. The relay may, in this case begin to oscillate or, even worse, have its moving part stuck between contacts.<br /><br />Yeah... have you ever flushed your WC? I bet you have! What if we'd have some kind of reservoir, a buffer of an energy to sustain the movement of the relay's moving part <b>after</b> the supply of current has been cut by feedback loop (i.e. after the moving part started to move)? We can achieve that by charging some large capacitor in advance, and making it discharge through the coils when switching is initiated. This is the whole idea of my solution. <br /><br />Finally, to ensure capacitors are charged enough before initiating relay switching, lets discharge them through the thyristor, activated when the voltage on the capacitor pins is above breakdown voltage of 4v3 Zener diode.<br /><br />Additional 2 diodes to prevent effects of EMF backfire at the relay coils, and we're done.</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEi1yrj0ZP3zoHIGxJYHDJln8-GphJGwY-4wvdeV5mJE9rGR2vK9jysNmX-28HIbe7fjIB055-3rrOKWv1Aqa0Iw0_EmBh6R_5nihtrj2vxbuoPLV66s_WDJCI_oIjtFN-83PF5EXCchGY_RgN0d0qKLU2WQB-VxCFOmmPUFiIRES9U8E-FqU1yVR_d8FpWm" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="1065" data-original-width="1545" height="442" src="https://blogger.googleusercontent.com/img/a/AVvXsEi1yrj0ZP3zoHIGxJYHDJln8-GphJGwY-4wvdeV5mJE9rGR2vK9jysNmX-28HIbe7fjIB055-3rrOKWv1Aqa0Iw0_EmBh6R_5nihtrj2vxbuoPLV66s_WDJCI_oIjtFN-83PF5EXCchGY_RgN0d0qKLU2WQB-VxCFOmmPUFiIRES9U8E-FqU1yVR_d8FpWm=w640-h442" width="640" /></a></div><div style="text-align: center;">(<i>Pulse Tone Rotary Dial</i> full schematics)<br /></div></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"><h3 style="text-align: left;">Wiring it all together</h3>One more thing. With nice, electrically driven 3PDT built on top of 2 EC2 relays, we need one more channel to short "pulse" and "common" phone terminals when rotatone is selected. This we could achieve at the level of physical switch driving the state change of relays. We could use DPDT instead of SPDT with one channel driving the relays and another shoritng "pulse" and "common" when required. And small-size DPDTs is one thing we can find!</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEg4gUf2D1jgNvBJshkXzSLgDQMNSRVxLz624k00xGmzZwAz_mMQJ-BAic6DpEIjB-iEedJK8Tgir3DRe9TjTp7_-WpxgsqOJ2tl_cGCdvm0q006TVLArrUVCIA5eqnuhQ-zvGqQFjU-NgUg0FSQy5uDZXkW-7NeEVcjVQpfSLAoRvkDse1k9ljahDHcoGGY" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="513" data-original-width="406" height="400" src="https://blogger.googleusercontent.com/img/a/AVvXsEg4gUf2D1jgNvBJshkXzSLgDQMNSRVxLz624k00xGmzZwAz_mMQJ-BAic6DpEIjB-iEedJK8Tgir3DRe9TjTp7_-WpxgsqOJ2tl_cGCdvm0q006TVLArrUVCIA5eqnuhQ-zvGqQFjU-NgUg0FSQy5uDZXkW-7NeEVcjVQpfSLAoRvkDse1k9ljahDHcoGGY=w316-h400" width="316" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEhyPYRTZGwu1YYLLSO9ANWJTMjHSgFu6XC7qE6_fdXG2aIXaz39Mlt1a8y2gJn3_kk_EFKtzrkzDtA93YnOSjbPrfpId5NBJzP5kDtODwbzvcxRgb2pcMhK5IZU7DD2YvVw4HNrLmOhfQpCSvJTr6Jb010Ldih1blx0fsHL2ccAcGLVsRxOyAo9xvaMkcGW" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="729" data-original-width="514" height="320" src="https://blogger.googleusercontent.com/img/a/AVvXsEhyPYRTZGwu1YYLLSO9ANWJTMjHSgFu6XC7qE6_fdXG2aIXaz39Mlt1a8y2gJn3_kk_EFKtzrkzDtA93YnOSjbPrfpId5NBJzP5kDtODwbzvcxRgb2pcMhK5IZU7DD2YvVw4HNrLmOhfQpCSvJTr6Jb010Ldih1blx0fsHL2ccAcGLVsRxOyAo9xvaMkcGW=w225-h320" width="225" />&nbsp;&nbsp;&nbsp; <img alt="" data-original-height="729" data-original-width="514" height="320" src="https://blogger.googleusercontent.com/img/a/AVvXsEhFIEfJw-xooGkQdSaWWStGQdBd7LEq1spthkgEAGbAvDcro8eDxzEOsbBO2MNfn6gTeVpzpQwxBalUz92FYRG7jTc7XgaL7N_H0H-EVQ43tPhO-84cOScRmOfg2Xu01PQUdkClim0KEVp9fAPKcmbsBbg6fn3_ghJWG9ykpmVpVM5YAV7Uz1ZD4jD3UGga=w225-h320" width="225" /></a> <br /></div></div><div style="text-align: center;">(PCB project and production simulation)<br /></div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEg0ag6xsaF8HkVXw2B7Giepsj5jRlEbWZAyLdtyIXhhc3tqf8d2JS-kMp8hyt0q4i0860YnSiK7mv210xRkK4APsWSdHhYbF-Jhn5ijc8tpwsXdym01OHulhEJia_IUuK40eFIOibaCtbaDfLvc9O5JRlxfHuS9qPh74LvRWlEacu2JokIjwhHOLysH9mJS" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="3072" data-original-width="4080" height="482" src="https://blogger.googleusercontent.com/img/a/AVvXsEg0ag6xsaF8HkVXw2B7Giepsj5jRlEbWZAyLdtyIXhhc3tqf8d2JS-kMp8hyt0q4i0860YnSiK7mv210xRkK4APsWSdHhYbF-Jhn5ijc8tpwsXdym01OHulhEJia_IUuK40eFIOibaCtbaDfLvc9O5JRlxfHuS9qPh74LvRWlEacu2JokIjwhHOLysH9mJS=w640-h482" width="640" /></a></div><div style="text-align: center;">(Breakout board version of <i>Pulse Tone Rotary Dial</i>)<br /></div></div><div style="text-align: left;"><br /></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"><br /><i>Rotarydial</i> author suggests to install the device "after" the hook, so it does get activated only when required - when the receiver is picked up. Fortunately in case of <i>Elektrim</i>, we have a separate connector inside the phone that allows you to tap into the line just after the hook.</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEjh3oU2-0WQ-A8IM4OkaMWBEl-QXpk19NEn-lpEDYiH42vLKcmrLm1iks60tny6LaVqtb5EtpXJ6NSwW0iTLS4gHvnqXMKohQSk5_YfZOJEJCanSwXcXuHkNODr90kOFylCDfo4H-x-fFSmgn5oFRrPS1xm0Wj-GCBCfmZhKBsw5Y7jUocstVsZ9c7OzU9D" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="2064" data-original-width="3000" height="440" src="https://blogger.googleusercontent.com/img/a/AVvXsEjh3oU2-0WQ-A8IM4OkaMWBEl-QXpk19NEn-lpEDYiH42vLKcmrLm1iks60tny6LaVqtb5EtpXJ6NSwW0iTLS4gHvnqXMKohQSk5_YfZOJEJCanSwXcXuHkNODr90kOFylCDfo4H-x-fFSmgn5oFRrPS1xm0Wj-GCBCfmZhKBsw5Y7jUocstVsZ9c7OzU9D=w640-h440" width="640" /></a></div><div style="text-align: center;">&nbsp;(Tapping rotarydial into the phone line inside RWT <i>Elektrim</i>)</div><div style="text-align: center;"><br /></div></div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEhw7DIKUtCtSEGS1qbXyHRvG_exL3sW2i_i5DngaWFh1IYwtM0sWzqbj3SH0D-6AXQF3qE9pr2v4UTr4nYnZGGJgwxDy6AlmAI7_QAPcOifuEHsL1ddV46RixGUBnYj-XdSQ3YIgF7NjKdUQQ_2yAnqOjhPw_5ieZp38NLO7hIP2GL8YKsLt1DC3LqeBxC7" style="margin-left: 1em; margin-right: 1em;"><img alt="" data-original-height="3072" data-original-width="4080" height="482" src="https://blogger.googleusercontent.com/img/a/AVvXsEhw7DIKUtCtSEGS1qbXyHRvG_exL3sW2i_i5DngaWFh1IYwtM0sWzqbj3SH0D-6AXQF3qE9pr2v4UTr4nYnZGGJgwxDy6AlmAI7_QAPcOifuEHsL1ddV46RixGUBnYj-XdSQ3YIgF7NjKdUQQ_2yAnqOjhPw_5ieZp38NLO7hIP2GL8YKsLt1DC3LqeBxC7=w640-h482" width="640" /></a></div></div><div style="text-align: center;">(Internal cable and receiver connectors of <i>Elektrim</i>.)<br /></div><div style="text-align: left;"><br />Further installation steps consist of connecting <i>rotarydial</i> to... rotary dial, connecting <i>rotarydial</i> to the connectors for the rotary dial on the phone side (to allow rotary dial to pass through pulses when in "pulse" mode) and connecting our infamous DPDT P-T switch. <br /><br />And I think I found the right place for it on the phone case.</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;">&nbsp;</div><div style="text-align: center;">[TODO: P-T switch location]<br /></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"><h3>&nbsp;</h3><h3>Final steps</h3>ATtiny85V needs to be programmed. HEX file with firmware, as well as the source code can be downloaded directly from the rotarydial's website. As for the programmer, I'm a proud owner of <i>AVR Dragon</i>, but I'm pretty sure any SPI programmer will do (<i>PonyProg</i>?). <br /><br />When designing PCB, my intention was to make it look as similar to the other PCB in the phone as possible. It turned out rather difficult to achieve due to size constraints and complication level of the circuitry. Yet, the final product is still a single-side board. Due to minimum trace spacing of 6 mil (!) I would not recommend etching your own PCB at home. Mine was produced by PCBWay.</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;">&nbsp;</div><div style="text-align: left;">&nbsp;</div><div style="text-align: center;">[TODO: real PCB]&nbsp;</div><div style="text-align: center;">&nbsp;</div><div style="text-align: center;">&nbsp;</div><div style="text-align: center;">&nbsp;</div><div style="text-align: center;">[TODO: assembled device]</div><div style="text-align: center;">&nbsp;</div><div style="text-align: center;">&nbsp;</div><div style="text-align: center;">&nbsp;</div><div style="text-align: center;">[TODO: device connected to Elektrim]</div><div style="text-align: center;">&nbsp;</div><div style="text-align: center;">&nbsp;</div><div style="text-align: center;">&nbsp;</div><div style="text-align: center;">[TODO: demo?]</div><div style="text-align: center;"><br /></div><div style="text-align: center;"><br /></div><div style="text-align: center;"><br /></div><div style="text-align: left;"></div><div style="text-align: left;"></div><div style="text-align: left;"><h3 style="text-align: left;">Downloads</h3><ul style="text-align: left;"><li style="text-align: left;">As always, you can find design files (EAGLE), Gerbers and BOM on GitHub:
 <a href="https://github.com/jan-baranowski/pulse-tone-rotary-dial">https://github.com/jan-baranowski/pulse-tone-rotary-dial</a></li><li style="text-align: left;">Details about original <i>rotarydial</i>, including the firmware, are to be found on Matthew Millman's website: <a href="https://www.mattmillman.com/projects/building-your-own-pulse-to-tone-converter/">https://www.mattmillman.com/projects/building-your-own-pulse-to-tone-converter/</a></li><li style="text-align: left;">Or maybe you're more interested in <i>Rotatone</i>: <a href="https://oldphoneworks.com/products/rotatone-pulse-to-tone-converter">https://oldphoneworks.com/products/rotatone-pulse-to-tone-converter</a></li><li style="text-align: left;">Information about 70s' polish phones can be found on dedicated website (in polish): <a href="http://telesfor.org/telefony-modele/cb-621631662/">http://telesfor.org/telefony-modele/cb-621631662/</a></li><li style="text-align: left;">Details of how analog phone works are pretty well explained on Wikipedia. Search for DTMF,&nbsp; pulse dialing, rotary dial, etc.</li><li style="text-align: left;">Finally, it looks like RWT is still in business! <a href="https://rwt.pl/">https://rwt.pl/</a></li></ul><h3 style="text-align: left;"><br /></h3></div>